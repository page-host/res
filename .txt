https://ideone.com/LUBmh4
1.Write a query for the HR department to produce the addresses of all the departments. 
Use the LOCATIONS and COUNTRIES tables. Show the location ID, street address, 
city, state or province, and country in the output. Use a NATURAL JOINto produce the 
results.

SELECT location_id, street_address,city, state_province, country_name
FROM locations
NATURAL JOIN countries
ORDER BY location_id;

2. The HR department needs a report of all employees. Write a queryto display the last 
name, department number, and department name for all employees

SELECT e.last_name, e.department_id, d.department_name
FROM employees e
JOIN departments d
ON e.department_id = d.department_id
ORDER BY e.department_id;

3.The HR department needs a report of employees in Toronto. Display the last name, job, 
department number, and department name for all employees who work in Toronto.

SELECT e.last_name, j.job_title AS job, e.department_id, d.department_name
FROM employees e
JOIN jobs j ON e.job_id = j.job_id
JOIN departments d ON e.department_id = d.department_id
JOIN locations l ON d.location_id = l.location_id
WHERE l.city = 'Toronto'
ORDER BY e.last_name;

4. Create a report to display employees’ last name and employee number along with their 
manager’s last name and manager number. Label the columns Employee, Emp#, 
Manager, and Mgr#, respectively.

SELECT e.last_name AS Employee, e.employee_id AS "Emp#",m.last_name AS Manager, m.employee_id AS "Mgr#"
FROM employees e
LEFT JOIN employees m
ON e.manager_id = m.employee_id
ORDER BY e.employee_id;

5. Display all employees including King, who has no manager. Order the results by the employee number.

SELECT e.last_name AS Employee, e.employee_id AS "Emp#",m.last_name AS Manager, m.employee_id AS "Mgr#"
FROM employees e
LEFT JOIN employees m
ON e.manager_id = m.employee_id
ORDER BY e.employee_id;



6. Displays employee last names, department  numbers, and all the employees who work in the same department as a given employee.

SELECT e1.last_name AS Employee, e1.department_id AS Dept, e2.last_name AS Colleague
FROM employees e1
JOIN employees e2
ON e1.department_id = e2.department_id
ORDER BY e1.department_id, e1.last_name, e2.last_name;

7. create a query that displays the name, job, department name, salary, and grade for all employees.

SELECT e.last_name AS Name, j.job_title AS Job, d.department_name AS Department,e.salary AS Salary,g.grade_level AS Grade
FROM employees e
JOIN jobs j ON e.job_id = j.job_id
JOIN departments d ON e.department_id = d.department_id
JOIN job_grades g 
ON e.salary BETWEEN g.lowest_sal AND g.highest_sal
ORDER BY e.last_name;

8. Create a query to display the name and hire date of any employee hired after employee Davies.

SELECT e.last_name AS Name, e.hire_date AS "Hire Date"
FROM employees e
WHERE e.hire_date > (SELECT hire_date FROM employees WHERE last_name = 'Davies')
ORDER BY e.hire_date;

9. The HR department needs to find the names and hire dates for all employees who were hired before their managers, along with their managers’ names and hire dates.

SELECT e.last_name AS Employee, e.hire_date AS "Emp Hire Date", m.last_name AS Manager, m.hire_date AS "Mgr Hire Date"
FROM employees e
JOIN employees m ON e.manager_id = m.employee_id
WHERE e.hire_date < m.hire_date
ORDER BY e.last_name;

10.The HR department needs a query that prompts the user for an employee last name. The query then displays the last name and hire date of any employee in the same department as the employee whose name they supply (excluding that employee). For example, if the user enters Zlotkey, find all employees who work with Zlotkey (excluding Zlotkey).

SELECT e.last_name AS Name, e.hire_date AS "Hire Date"
FROM employees e
WHERE e.department_id = (SELECT department_id FROM employees WHERE last_name = :lname)
AND e.last_name <> :lname
ORDER BY e.last_name;

11. Create a report that displays the employee number, last name, and salary of all employees who earn more than the average salary. Sort the results in order of ascending salary

SELECT e.employee_id AS "Emp#", e.last_name AS Name, e.salary AS Salary
FROM employees e
WHERE e.salary > (SELECT AVG(salary) FROM employees)
ORDER BY e.salary ASC;

12. Write a query that displays the employee number and last name of all employees who work in a department with any employee whose last name contains a u.

SELECT e.employee_id AS "Emp#", e.last_name AS Name
FROM employees e
WHERE e.department_id IN (SELECT department_id FROM employees WHERE last_name LIKE '%u%')
ORDER BY e.employee_id;

13. The HR department needs a report that displays the last name, department number, and job ID of all employees whose department location ID is 1700.

SELECT e.last_name AS Name, e.department_id AS "Dept#", e.job_id AS Job
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE d.location_id = 1700
ORDER BY e.last_name;

14. Create a report for HR that displays the last name and salary of every employee who reports to King

SELECT e.last_name AS Name, e.department_id AS "Dept#", e.job_id AS Job
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE d.location_id = 1700
ORDER BY e.last_name;

15. Create a report for HR that displays the department number, last name, and job ID for every employee in the Executive department.

SELECT e.department_id AS "Dept#", e.last_name AS Name, e.job_id AS Job
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE d.department_name = 'Executive'
ORDER BY e.last_name;

16. display the employee number, last name, and salary of all employees who earn more than the average salary and who work in a department with any employee whose last name contains a u.

SELECT e.employee_id AS "Emp#", e.last_name AS Name, e.salary AS Salary
FROM employees e
WHERE e.salary > (SELECT AVG(salary) FROM employees)
AND e.department_id IN (SELECT department_id FROM employees WHERE last_name LIKE '%u%')
ORDER BY e.salary ASC;
